"use strict";function getWikiData(e){var r=navigator.language||navigator.userLanguage,t="https://"+r+".wikipedia.org/w/api.php?action=query&format=json&formatversion=2&list=search&continue=&srsearch="+e+"&srwhat=text&srprop=wordcount&origin=*",n=new Headers;n.append("Api-User-Agent","Example/1.0"),fetch(t,{headers:n}).then(function(r){if(r.ok)return r.json();throw new Error("Could not get the Wikipage for "+e+"!")}).then(function(a){if(a.error)throw console.warn(a.error.info),{code:a.error.code,message:a.error.info};if(0===a.query.search.length)throw console.warn(a.query.search),{code:"NoSuchPage",message:"There is no page for "+e};console.log("pageId="+a.query.search[0].pageid);var o=a.query.search[0].pageid;return t="https://"+r+".wikipedia.org/w/api.php?action=parse&format=json&formatversion=2&pageid="+o+"&origin=*",fetch(t,{headers:n})}).then(function(e){if(e.ok)return e.json();throw new Error("Error while retrieving page with id "+pageId)}).then(function(e){if(e.error)throw console.warn(e.error.info),{code:e.error.code,message:e.error.info};return parseData(e)}).then(function(e){showData(e,document.querySelector(".external__data"))}).catch(function(e){return console.error(e.code||" "+e.message+e.stack)})}function parseData(e){if(e.parse.text)return e.parse.text["*"]||e.parse.text}function showData(e,r){r.innerHTML=e;for(var t=document.querySelectorAll("a"),n=0;n<t.length;n++)/wiki|w/g.test(t[n].pathname)&&(t[n].host="www.wikipedia.org",t[n].port=443)}function clearData(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function validateInput(e){return e.replace(/([.,;:=+\[\]\\\|\/?<>!@#$%^&*()'"\n\r]*?)([\w\s\t\r\n]+)/gi,"$2")}function searchPhrase(){var e=document.querySelector("#searchInput"),r=document.querySelector(".external__data"),t=validateInput(e.value);console.log(t),clearData(r),getWikiData(t)}function searchRandom(){}var submitBtnElm=document.querySelector("#searchBtnSubmit"),randomBtnElm=document.querySelector("#searchBtnRandom"),inputElm=document.querySelector("#searchInput");submitBtnElm.addEventListener("click",searchPhrase),randomBtnElm.addEventListener("click",searchRandom),inputElm.addEventListener("keypress",function(e){"Enter"===e.key&&searchPhrase()});
//# sourceMappingURL=script_old.js.map
